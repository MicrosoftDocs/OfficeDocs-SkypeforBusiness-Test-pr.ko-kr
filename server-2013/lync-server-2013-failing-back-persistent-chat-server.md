---
title: 'Lync Server 2013: 영구 채팅 서버 장애 복구(failback)'
TOCTitle: 영구 채팅 서버 장애 복구(failback)
ms:assetid: 67b91de4-6ddc-43e6-9812-5e1aa84a7980
ms:mtpsurl: https://technet.microsoft.com/ko-kr/library/JJ204970(v=OCS.15)
ms:contentKeyID: 49303885
ms.date: 08/24/2015
mtps_version: v=OCS.15
ms.translationtype: HT
---

# Lync Server 2013에서 영구 채팅 서버 장애 복구(failback)

 

_**마지막으로 수정된 항목:** 2014-02-05_

이 절차에서는 영구 채팅 서버 오류로부터 복구하고 기본 데이터 센터에서 작업을 다시 설정하기 위해 필요한 단계에 대해 개괄적으로 설명합니다.

영구 채팅 서버 오류 중 기본 데이터 센터는 완전히 중단되고 기본 및 미러 데이터베이스를 사용할 수 없습니다. 기본 데이터 센터는 백업 서버로 장애 조치(failover)됩니다.

다음 절차에서는 기본 데이터 센터가 백업되고 서버를 다시 구축한 후에 일반 작업을 복원합니다. 이 절차에서는 기본 데이터 센터가 작동 중단 상태에서 복구되었고 토폴로지 작성기를 사용하여 mgc 데이터베이스 및 mgccomp 데이터베이스가 다시 구축되고 다시 설치되었다고 가정합니다.

이 절차에서는 또한 장애 조치(failover) 기간 중에 새로운 미러 및 백업 서버가 배포되지 않았고 [Lync Server 2013에서 영구 채팅 서버 장애 조치(failover)](lync-server-2013-failing-over-persistent-chat-server.md)에 설명된 대로 배포된 서버는 백업 서버와 해당 미러 서버뿐이라고 가정합니다.

이러한 단계는 구성을 재해 이전의 상태로 복구하여 기본 서버를 백업 서버로 장애 조치(failover)하도록 디자인되었습니다.

## 영구 채팅 서버를 복구(failback)하려면

1.  Lync Server 관리 셸에서 `Set-CsPersistentChatActiveServer` cmdlet을 사용하여 영구 채팅 서버 활성 서버 목록에서 모든 서버를 지웁니다. 이렇게 하면 모든 영구 채팅 서버가 복구(failback) 중에 mgc 데이터베이스 및 mgccomp 데이터베이스에 연결하지 못합니다.
    

    > [!IMPORTANT]
    > 보조 영구 채팅 서버 백 엔드 서버의 SQL Server 에이전트는 권한이 부여된 계정으로 실행되어야 합니다. 특히 이 계정은 다음과 같은 권한을 포함해야 합니다. 
    > <UL>
    > <LI>
    > <P>백업을 배치 중인 네트워크 공유에 대한 읽기 액세스 권한</P>
    > <LI>
    > <P>백업을 복사 중인 특정 로컬 디렉터리에 대한 쓰기 액세스 권한</P></LI></UL>



2.  백업 mgc 데이터베이스에서 미러링 해제:
    
    1.  SQL Server Management Studio를 사용하여 백업 mgc 인스턴스에 연결합니다.
    
    2.  mgc 데이터베이스를 마우스 오른쪽 단추로 클릭하고 **작업** 을 가리킨 후 **미러** 를 클릭합니다.
    
    3.  **미러링 제거** 를 클릭합니다.
    
    4.  **확인** 을 클릭합니다.
    
    5.  mgccomp 데이터베이스에서도 같은 단계를 수행합니다.

3.  새 기본 데이터베이스로 복원할 수 있도록 mgc 데이터베이스를 백업합니다.
    
    1.  SQL Server Management Studio를 사용하여 백업 mgc 인스턴스에 연결합니다.
    
    2.  mgc 데이터베이스를 마우스 오른쪽 단추로 클릭하고 **작업** 을 가리킨 후 **백업** 을 클릭합니다. **데이터베이스 백업** 대화 상자가 나타납니다.
    
    3.  **백업 유형** 에서 **전체** 를 선택합니다.
    
    4.  **백업 구성 요소** 에 대해 **데이터베이스** 를 클릭합니다.
    
    5.  **이름** 에 제안된 기본 백업 집합 이름을 사용하거나 백업 집합에 대해 다른 이름을 입력합니다.
    
    6.  *\<선택 사항\>* **설명** 에 백업 집합에 대한 설명을 입력합니다.
    
    7.  대상 목록에서 기본 백업 위치를 제거합니다.
    
    8.  로그 전달을 위해 설정한 공유 위치에 대한 경로를 사용해서 목록에 파일을 추가합니다. 이 경로는 기본 데이터베이스 및 백업 데이터베이스 모두 사용할 수 있습니다.
    
    9.  **확인** 을 클릭하여 대화 상자를 닫고 백업 프로세스를 시작합니다.

4.  이전 단계에서 만든 백업 데이터베이스를 사용하여 기본 데이터베이스를 복원합니다.
    
    1.  SQL Server Management Studio를 사용하여 기본 mgc 인스턴스에 연결합니다.
    
    2.  mgc 데이터베이스를 마우스 오른쪽 단추로 클릭하고 **작업** , **복원** 을 차례로 클릭한 후 **데이터베이스** 를 클릭합니다. **데이터베이스 복원** 대화 상자가 나타납니다.
    
    3.  **장치에서** 를 선택합니다.
    
    4.  찾아보기 단추를 클릭하여 **백업 지정** 대화 상자를 엽니다. **백업 미디어** 에서 **파일** 을 선택합니다. **추가** 를 클릭하고 3단계에서 만든 백업 파일을 선택한 후 **확인** 을 클릭합니다.
    
    5.  **복원할 백업 집합 선택** 에서 백업을 선택합니다.
    
    6.  **페이지 선택** 창에서 **옵션** 을 클릭합니다.
    
    7.  **복원 옵션** 에서 **기존 데이터베이스 덮어쓰기** 를 선택합니다.
    
    8.  **복구 상태** 에서 **데이터베이스를 사용할 수 있는 상태로 유지합니다.** 를 선택합니다.
    
    9.  **확인** 을 클릭하여 복원 프로세스를 시작합니다.

5.  기본 데이터베이스에 대한 SQL Server 로그 전달을 구성합니다. 기본 mgc 데이터베이스에 대한 로그 전달을 설정하려면 [Lync Server 2013에서 고가용성 및 재해 복구를 위한 영구 채팅 서버 구성](lync-server-2013-configuring-persistent-chat-server-for-high-availability-and-disaster-recovery.md)의 절차를 따릅니다.

6.  영구 채팅 서버 활성 서버를 설정합니다. Lync Server 관리 셸에서 **Set-CsPersistentChatActiveServer** cmdlet을 사용하여 활성 서버 목록을 설정합니다.
    

    > [!IMPORTANT]
    > 모든 활성 서버는 새 기본 데이터베이스와 동일한 데이터 센터 내에 배치하거나 데이터베이스에 대한 연결 대기 시간이 낮고 대역폭이 높은 데이터 센터에 배치해야 합니다.



풀을 일반 상태로 복원하려면 Windows PowerShell 명령을 실행합니다.

    Set-CsPersistentChatState -Identity "service: lyncpc.dci.discovery.com" -PoolState Normal

자세한 내용은 [Set-CsPersistentChatState](https://docs.microsoft.com/en-us/powershell/module/skype/Set-CsPersistentChatState) cmdlet에 대한 도움말 항목을 참고하세요.

